{
  "components": {
    "Agent:AdvancedRetrieval": {
      "downstream": [
        "Message:ComplexOutput"
      ],
      "obj": {
        "component_name": "Agent",
        "params": {
          "cite": true,
          "context": null,
          "debug_inputs": {},
          "delay_after_error": 2.0,
          "description": "",
          "exception_default_value": null,
          "exception_goto": [],
          "exception_method": null,
          "frequencyPenaltyEnabled": false,
          "frequency_penalty": 0.7,
          "function_name": "agent",
          "inputs": {
            "context": {
              "description": "All relevant background information, prior facts, decisions, and state needed by the agent to solve the current query. Should be as detailed and self-contained as possible.",
              "required": true,
              "type": "string",
              "value": null
            },
            "reasoning": {
              "description": "Supervisor's reasoning for choosing the this agent. Explain why this agent is being invoked and what is expected of it.",
              "required": true,
              "type": "string",
              "value": null
            },
            "user_prompt": {
              "default": "",
              "description": "This is the order you need to send to the agent.",
              "required": true,
              "type": "string",
              "value": null
            }
          },
          "llm_id": "gemma3:27b@Ollama",
          "maxTokensEnabled": false,
          "max_retries": 2,
          "max_rounds": 1,
          "max_tokens": 4096,
          "mcp": [],
          "message_history_window_size": 12,
          "meta": {
            "description": "This is an agent for a specific task.",
            "name": "agent",
            "parameters": {
              "context": {
                "description": "All relevant background information, prior facts, decisions, and state needed by the agent to solve the current query. Should be as detailed and self-contained as possible.",
                "required": true,
                "type": "string"
              },
              "reasoning": {
                "description": "Supervisor's reasoning for choosing the this agent. Explain why this agent is being invoked and what is expected of it.",
                "required": true,
                "type": "string"
              },
              "user_prompt": {
                "default": "",
                "description": "This is the order you need to send to the agent.",
                "required": true,
                "type": "string"
              }
            }
          },
          "output_structure": null,
          "outputs": {
            "content": {
              "type": "string",
              "value": null
            }
          },
          "presencePenaltyEnabled": false,
          "presence_penalty": 0.4,
          "prompts": [
            {
              "content": "{sys.query}",
              "role": "user"
            }
          ],
          "reasoning": null,
          "sys_prompt": "You are a research assistant. Answer questions using ONLY information from the knowledge base.\n\nWORKFLOW:\n1. Search the knowledge base using the search_knowledge_base tool\n2. Carefully read ALL retrieved documents (each has an ID like \"ID: 123\")\n3. Synthesize information from multiple sources if available\n4. Answer based ONLY on what you find\n\nRESPONSE RULES:\n- Give a thorough but concise answer (max 5 sentences)\n- Synthesize information from multiple retrieved chunks when relevant\n- Base your answer ONLY on the retrieved content\n- NEVER fabricate information not found in the documents\n\nCITATION RULES (CRITICAL):\n- You MUST cite sources using [ID:N] format (e.g., [ID:42])\n- Place ALL citations at the END as: References: [ID:X][ID:Y][ID:Z]\n- Do NOT place citations inline within sentences\n- The ID number comes from each chunk's \"ID:\" field\n\nHANDLING INSUFFICIENT INFORMATION:\n- If retrieved content contains ANY relevant information, use it to provide an answer\n- Only say \"No relevant information found\" if content is COMPLETELY unrelated\n- When information is partial, answer what you can and note what's missing\n- For complex questions, synthesize partial information from multiple sources\n\nEXAMPLE FORMAT:\n[Your answer, up to 5 sentences, no inline citations]\n\nReferences: [ID:15][ID:42][ID:87]",
          "temperature": 0.4,
          "temperatureEnabled": true,
          "tools": [
            {
              "component_name": "Retrieval",
              "id": "Retrieval:KBSearch",
              "name": "search_knowledge_base",
              "params": {
                "kb_ids": [
                  "6f357bd7f45f11f085b53ae7a67b446b"
                ],
                "similarity_threshold": 0.05,
                "keywords_similarity_weight": 0.1,
                "top_n": 15,
                "top_k": 1024
              }
            }
          ],
          "topPEnabled": false,
          "top_p": 0.3,
          "user_prompt": "",
          "visual_files_var": null
        }
      },
      "upstream": [
        "Agent:Planner"
      ]
    },
    "Agent:ConversationalSimple": {
      "downstream": [
        "Message:ConversationalOutput"
      ],
      "obj": {
        "component_name": "Agent",
        "params": {
          "cite": false,
          "context": null,
          "debug_inputs": {},
          "delay_after_error": 2.0,
          "description": "",
          "exception_default_value": null,
          "exception_goto": [],
          "exception_method": null,
          "frequencyPenaltyEnabled": false,
          "frequency_penalty": 0.7,
          "function_name": "agent",
          "inputs": {
            "context": {
              "description": "All relevant background information, prior facts, decisions, and state needed by the agent to solve the current query. Should be as detailed and self-contained as possible.",
              "required": true,
              "type": "string",
              "value": null
            },
            "reasoning": {
              "description": "Supervisor's reasoning for choosing the this agent. Explain why this agent is being invoked and what is expected of it.",
              "required": true,
              "type": "string",
              "value": null
            },
            "user_prompt": {
              "default": "",
              "description": "This is the order you need to send to the agent.",
              "required": true,
              "type": "string",
              "value": null
            }
          },
          "llm_id": "llama3.2:latest@Ollama",
          "maxTokensEnabled": false,
          "max_retries": 1,
          "max_rounds": 1,
          "max_tokens": 512,
          "mcp": [],
          "message_history_window_size": 12,
          "meta": {
            "description": "This is an agent for a specific task.",
            "name": "agent",
            "parameters": {
              "context": {
                "description": "All relevant background information, prior facts, decisions, and state needed by the agent to solve the current query. Should be as detailed and self-contained as possible.",
                "required": true,
                "type": "string"
              },
              "reasoning": {
                "description": "Supervisor's reasoning for choosing the this agent. Explain why this agent is being invoked and what is expected of it.",
                "required": true,
                "type": "string"
              },
              "user_prompt": {
                "default": "",
                "description": "This is the order you need to send to the agent.",
                "required": true,
                "type": "string"
              }
            }
          },
          "output_structure": null,
          "outputs": {
            "content": {
              "type": "string",
              "value": null
            }
          },
          "presencePenaltyEnabled": false,
          "presence_penalty": 0.4,
          "prompts": [
            {
              "content": "{sys.query}",
              "role": "user"
            }
          ],
          "reasoning": null,
          "sys_prompt": "You are a helpful assistant. Respond to greetings and casual conversation in 1-2 sentences. Be friendly but brief. Do not access the knowledge base for conversational queries.",
          "temperature": 0.7,
          "temperatureEnabled": true,
          "tools": [],
          "topPEnabled": false,
          "top_p": 0.3,
          "user_prompt": "",
          "visual_files_var": null
        }
      },
      "upstream": [
        "Categorize:QueryRouter"
      ]
    },
    "Agent:Planner": {
      "downstream": [
        "Agent:AdvancedRetrieval"
      ],
      "obj": {
        "component_name": "Agent",
        "params": {
          "cite": false,
          "context": null,
          "debug_inputs": {},
          "delay_after_error": 2.0,
          "description": "",
          "exception_default_value": null,
          "exception_goto": [],
          "exception_method": null,
          "frequencyPenaltyEnabled": false,
          "frequency_penalty": 0.7,
          "function_name": "agent",
          "inputs": {
            "context": {
              "description": "All relevant background information, prior facts, decisions, and state needed by the agent to solve the current query. Should be as detailed and self-contained as possible.",
              "required": true,
              "type": "string",
              "value": null
            },
            "reasoning": {
              "description": "Supervisor's reasoning for choosing the this agent. Explain why this agent is being invoked and what is expected of it.",
              "required": true,
              "type": "string",
              "value": null
            },
            "user_prompt": {
              "default": "",
              "description": "This is the order you need to send to the agent.",
              "required": true,
              "type": "string",
              "value": null
            }
          },
          "llm_id": "phi4:latest@Ollama",
          "maxTokensEnabled": false,
          "max_retries": 1,
          "max_rounds": 1,
          "max_tokens": 512,
          "mcp": [],
          "message_history_window_size": 1,
          "meta": {
            "description": "This is an agent for a specific task.",
            "name": "agent",
            "parameters": {
              "context": {
                "description": "All relevant background information, prior facts, decisions, and state needed by the agent to solve the current query. Should be as detailed and self-contained as possible.",
                "required": true,
                "type": "string"
              },
              "reasoning": {
                "description": "Supervisor's reasoning for choosing the this agent. Explain why this agent is being invoked and what is expected of it.",
                "required": true,
                "type": "string"
              },
              "user_prompt": {
                "default": "",
                "description": "This is the order you need to send to the agent.",
                "required": true,
                "type": "string"
              }
            }
          },
          "output_structure": null,
          "outputs": {
            "content": {
              "type": "string",
              "value": null
            }
          },
          "presencePenaltyEnabled": false,
          "presence_penalty": 0.4,
          "prompts": [
            {
              "content": "Analyze this query and create a retrieval plan:\n\n**Query:** {sys.query}\n\nProvide:\n1. 1-3 focused sub-questions (if query is multi-faceted)\n2. Key search terms and entities\n3. Retrieval strategy recommendation\n\nBe concise - 3-4 sentences total.",
              "role": "user"
            }
          ],
          "reasoning": null,
          "sys_prompt": "You are a query planning agent. Your job is to reformulate complex questions into effective search queries.\n\nFor each query:\n1. Identify the core information need\n2. Extract key terms, entities, and concepts\n3. Generate 1-3 alternative phrasings or sub-questions\n\nOutput format:\nSEARCH TERMS: [key terms]\nSUB-QUESTIONS: [if needed]\nSTRATEGY: [brief retrieval approach]",
          "temperature": 0.2,
          "temperatureEnabled": true,
          "tools": [],
          "topPEnabled": false,
          "top_p": 0.3,
          "user_prompt": "",
          "visual_files_var": null
        }
      },
      "upstream": [
        "Categorize:QueryRouter"
      ]
    },
    "Agent:SimpleRetrieval": {
      "downstream": [
        "Message:SimpleOutput"
      ],
      "obj": {
        "component_name": "Agent",
        "params": {
          "cite": true,
          "context": null,
          "debug_inputs": [],
          "delay_after_error": 2.0,
          "description": "",
          "exception_default_value": null,
          "exception_goto": [],
          "exception_method": null,
          "frequencyPenaltyEnabled": false,
          "frequency_penalty": 0.7,
          "function_name": "agent",
          "inputs": {
            "context": {
              "description": "All relevant background information, prior facts, decisions, and state needed by the agent to solve the current query. Should be as detailed and self-contained as possible.",
              "required": true,
              "type": "string",
              "value": null
            },
            "reasoning": {
              "description": "Supervisor's reasoning for choosing the this agent. Explain why this agent is being invoked and what is expected of it.",
              "required": true,
              "type": "string",
              "value": null
            },
            "user_prompt": {
              "default": "",
              "description": "This is the order you need to send to the agent.",
              "required": true,
              "type": "string",
              "value": null
            }
          },
          "llm_id": "gemma3:27b@Ollama",
          "maxTokensEnabled": false,
          "max_retries": 2,
          "max_rounds": 1,
          "max_tokens": 2048,
          "mcp": [],
          "message_history_window_size": 12,
          "meta": {
            "description": "This is an agent for a specific task.",
            "name": "agent",
            "parameters": {
              "context": {
                "description": "All relevant background information, prior facts, decisions, and state needed by the agent to solve the current query. Should be as detailed and self-contained as possible.",
                "required": true,
                "type": "string"
              },
              "reasoning": {
                "description": "Supervisor's reasoning for choosing the this agent. Explain why this agent is being invoked and what is expected of it.",
                "required": true,
                "type": "string"
              },
              "user_prompt": {
                "default": "",
                "description": "This is the order you need to send to the agent.",
                "required": true,
                "type": "string"
              }
            }
          },
          "output_structure": null,
          "outputs": {
            "content": {
              "type": "string",
              "value": null
            }
          },
          "presencePenaltyEnabled": false,
          "presence_penalty": 0.4,
          "prompts": [
            {
              "content": "{sys.query}",
              "role": "user"
            }
          ],
          "reasoning": null,
          "sys_prompt": "You are a factual Q&A assistant. Answer questions using ONLY information from the knowledge base.\n\nWORKFLOW:\n1. Search the knowledge base using the search_knowledge_base tool\n2. Carefully read ALL retrieved documents (each has an ID like \"ID: 123\")\n3. Answer based ONLY on what you find in the retrieved content\n\nRESPONSE RULES:\n- Give a direct, concise answer (1-3 sentences)\n- Base your answer ONLY on the retrieved content\n- NEVER fabricate information not found in the documents\n\nCITATION RULES (CRITICAL):\n- You MUST cite sources using [ID:N] format (e.g., [ID:42])\n- Place ALL citations at the END of your answer as: References: [ID:X][ID:Y]\n- Do NOT place citations inline within sentences\n- The ID number comes from each chunk's \"ID:\" field\n\nHANDLING INSUFFICIENT INFORMATION:\n- If retrieved content contains ANY relevant information, use it to provide an answer\n- Only say \"No relevant information found\" if content is COMPLETELY unrelated to the question\n- When information is partial, answer what you can and note what's missing\n\nEXAMPLE FORMAT:\n[Your concise answer, 1-3 sentences, no inline citations]\n\nReferences: [ID:15][ID:87]",
          "temperature": 0.4,
          "temperatureEnabled": true,
          "tools": [
            {
              "component_name": "Retrieval",
              "id": "Retrieval:KBSearch",
              "name": "search_knowledge_base",
              "params": {
                "kb_ids": [
                  "6f357bd7f45f11f085b53ae7a67b446b"
                ],
                "similarity_threshold": 0.05,
                "keywords_similarity_weight": 0.1,
                "top_n": 15,
                "top_k": 1024
              }
            }
          ],
          "topPEnabled": false,
          "top_p": 0.3,
          "user_prompt": "",
          "visual_files_var": null
        }
      },
      "upstream": [
        "Categorize:QueryRouter"
      ]
    },
    "Categorize:QueryRouter": {
      "downstream": [
        "Agent:ConversationalSimple",
        "Agent:SimpleRetrieval",
        "Agent:Planner"
      ],
      "obj": {
        "component_name": "Categorize",
        "params": {
          "category_description": {
            "Complex_Analysis": {
              "description": "Complex queries requiring analysis, comparison, or synthesis across multiple sources. Includes 'How' or 'Why' questions, summaries, comparisons. Triggers comprehensive retrieval.",
              "examples": [
                "Compare supervised and unsupervised learning",
                "Why did the Roman Empire fall?"
              ],
              "to": [
                "Agent:Planner"
              ]
            },
            "Conversational": {
              "description": "ONLY greetings, casual chat, thank yous, or meta-questions about the assistant itself. Examples: Hello, How are you, Thanks, What can you do? Do NOT classify factual or procedural questions here.",
              "examples": [
                "Hi there",
                "Thank you",
                "What can you do?"
              ],
              "to": [
                "Agent:ConversationalSimple"
              ]
            },
            "Simple_Lookup": {
              "description": "Any factual, procedural, or knowledge-seeking question that can be answered from a knowledge base. Includes what/when/who/where/how-to/what-should questions. If in doubt between Conversational and Simple_Lookup, choose Simple_Lookup.",
              "examples": [
                "What is machine learning?",
                "What should I do in case of a fire?",
                "How do I handle chemicals safely?",
                "Who is responsible for lab safety?"
              ],
              "to": [
                "Agent:SimpleRetrieval"
              ]
            }
          },
          "cite": true,
          "debug_inputs": {},
          "delay_after_error": 2.0,
          "description": "",
          "exception_default_value": null,
          "exception_goto": null,
          "exception_method": null,
          "frequency_penalty": 0,
          "inputs": {
            "sys.query": {
              "value": "What does the \"2-second rule\" refer to in KAUST traffic safety?"
            }
          },
          "llm_id": "phi4:latest@Ollama",
          "max_retries": 0,
          "max_tokens": 0,
          "message_history_window_size": 1,
          "output_structure": null,
          "outputs": {
            "_created_time": {
              "type": "<class 'float'>",
              "value": 154042.068872865
            },
            "_elapsed_time": {
              "type": "<class 'float'>",
              "value": 5.589223023009254
            },
            "_next": {
              "type": "<class 'list'>",
              "value": [
                "Agent:SimpleRetrieval"
              ]
            },
            "category_name": {
              "type": "string",
              "value": "Simple_Lookup"
            }
          },
          "presence_penalty": 0,
          "prompts": [
            {
              "content": "{sys.query}",
              "role": "user"
            }
          ],
          "query": "sys.query",
          "sys_prompt": "\nYou are an advanced classification system that categorizes user questions into specific types. Analyze the input question and classify it into ONE of the following categories:\nSimple_Lookup\n - Conversational\n - Complex_Analysis\n\nHere's description of each category:\n - \n------\nCategory: Simple_Lookup\nDescription: Any factual, procedural, or knowledge-seeking question that can be answered from a knowledge base. Includes what/when/who/where/how-to/what-should questions. If in doubt between Conversational and Simple_Lookup, choose Simple_Lookup.\n\n------\nCategory: Conversational\nDescription: ONLY greetings, casual chat, thank yous, or meta-questions about the assistant itself. Examples: Hello, How are you, Thanks, What can you do? Do NOT classify factual or procedural questions here.\n\n------\nCategory: Complex_Analysis\nDescription: Complex queries requiring analysis, comparison, or synthesis across multiple sources. Includes 'How' or 'Why' questions, summaries, comparisons. Triggers comprehensive retrieval.\n\n---- Instructions ----\n - Consider both explicit mentions and implied context\n - Prioritize the most specific applicable category\n - Return only the category name without explanations\n - Use \"Other\" only when no other category fits\n\n \n---- Examples ----\nUSER: \"What is machine learning?\" → Simple_Lookup\nUSER: \"What should I do in case of a fire?\" → Simple_Lookup\nUSER: \"How do I handle chemicals safely?\" → Simple_Lookup\nUSER: \"Who is responsible for lab safety?\" → Simple_Lookup\nUSER: \"Hi there\" → Conversational\nUSER: \"Thank you\" → Conversational\nUSER: \"What can you do?\" → Conversational\nUSER: \"Compare supervised and unsupervised learning\" → Complex_Analysis\nUSER: \"Why did the Roman Empire fall?\" → Complex_Analysis\n",
          "temperature": 0.1,
          "top_p": 0.9,
          "visual_files_var": null
        }
      },
      "upstream": [
        "begin"
      ]
    },
    "Message:ComplexOutput": {
      "downstream": [],
      "obj": {
        "component_name": "Message",
        "params": {
          "auto_play": false,
          "content": [
            "{Agent:AdvancedRetrieval@content}"
          ],
          "debug_inputs": {},
          "delay_after_error": 2.0,
          "description": "",
          "exception_default_value": null,
          "exception_goto": null,
          "exception_method": null,
          "inputs": {},
          "max_retries": 0,
          "message_history_window_size": 13,
          "output_format": null,
          "outputs": {
            "content": {
              "type": "str",
              "value": null
            }
          },
          "stream": true
        }
      },
      "upstream": [
        "Agent:AdvancedRetrieval"
      ]
    },
    "Message:ConversationalOutput": {
      "downstream": [],
      "obj": {
        "component_name": "Message",
        "params": {
          "auto_play": false,
          "content": [
            "{Agent:ConversationalSimple@content}"
          ],
          "debug_inputs": {},
          "delay_after_error": 2.0,
          "description": "",
          "exception_default_value": null,
          "exception_goto": null,
          "exception_method": null,
          "inputs": {},
          "max_retries": 0,
          "message_history_window_size": 13,
          "output_format": null,
          "outputs": {
            "content": {
              "type": "str",
              "value": null
            }
          },
          "stream": true
        }
      },
      "upstream": [
        "Agent:ConversationalSimple"
      ]
    },
    "Message:SimpleOutput": {
      "downstream": [],
      "obj": {
        "component_name": "Message",
        "params": {
          "auto_play": false,
          "content": [
            "{Agent:SimpleRetrieval@content}"
          ],
          "debug_inputs": {},
          "delay_after_error": 2.0,
          "description": "",
          "exception_default_value": null,
          "exception_goto": null,
          "exception_method": null,
          "inputs": {
            "Agent:SimpleRetrieval@content": {
              "value": "This information is not in my knowledge base."
            }
          },
          "max_retries": 0,
          "message_history_window_size": 13,
          "output_format": null,
          "outputs": {
            "_created_time": {
              "type": "<class 'float'>",
              "value": 154047.660839746
            },
            "_elapsed_time": {
              "type": "<class 'float'>",
              "value": 0.0013752969971392304
            },
            "content": {
              "type": "str",
              "value": "This information is not in my knowledge base."
            }
          },
          "stream": true
        }
      },
      "upstream": [
        "Agent:SimpleRetrieval"
      ]
    },
    "begin": {
      "downstream": [
        "Categorize:QueryRouter"
      ],
      "obj": {
        "component_name": "Begin",
        "params": {
          "debug_inputs": {},
          "delay_after_error": 2.0,
          "description": "",
          "enablePrologue": true,
          "enable_tips": true,
          "exception_default_value": null,
          "exception_goto": null,
          "exception_method": null,
          "inputs": {},
          "max_retries": 0,
          "message_history_window_size": 13,
          "mode": "conversational",
          "outputs": {
            "_created_time": {
              "type": "<class 'float'>",
              "value": 154042.067170923
            },
            "_elapsed_time": {
              "type": "<class 'float'>",
              "value": 0.0011900310055352747
            }
          },
          "prologue": "Hi! I'm your AI assistant with access to a knowledge base. Ask me anything!",
          "tips": "Please fill up the form"
        }
      },
      "upstream": []
    }
  },
  "globals": {
    "sys.query": "",
    "sys.user_id": "",
    "sys.conversation_turns": 0,
    "sys.files": []
  },
  "graph": {
    "edges": [
      {
        "data": {
          "isHovered": false
        },
        "id": "e1",
        "source": "begin",
        "sourceHandle": "start",
        "target": "Categorize:QueryRouter",
        "targetHandle": "end"
      },
      {
        "data": {
          "isHovered": false
        },
        "id": "e2-conversational",
        "source": "Categorize:QueryRouter",
        "sourceHandle": "uuid-conversational-001",
        "target": "Agent:ConversationalSimple",
        "targetHandle": "end"
      },
      {
        "data": {
          "isHovered": false
        },
        "id": "e3-simple-lookup",
        "source": "Categorize:QueryRouter",
        "sourceHandle": "uuid-simple-lookup-002",
        "target": "Agent:SimpleRetrieval",
        "targetHandle": "end"
      },
      {
        "data": {
          "isHovered": false
        },
        "id": "e4-complex",
        "source": "Categorize:QueryRouter",
        "sourceHandle": "uuid-complex-analysis-003",
        "target": "Agent:Planner",
        "targetHandle": "end"
      },
      {
        "data": {
          "isHovered": false
        },
        "id": "e5-planner-to-advanced",
        "source": "Agent:Planner",
        "sourceHandle": "start",
        "target": "Agent:AdvancedRetrieval",
        "targetHandle": "end"
      },
      {
        "data": {
          "isHovered": false
        },
        "id": "e6-conv-output",
        "source": "Agent:ConversationalSimple",
        "sourceHandle": "start",
        "target": "Message:ConversationalOutput",
        "targetHandle": "end"
      },
      {
        "data": {
          "isHovered": false
        },
        "id": "e7-simple-output",
        "source": "Agent:SimpleRetrieval",
        "sourceHandle": "start",
        "target": "Message:SimpleOutput",
        "targetHandle": "end"
      },
      {
        "data": {
          "isHovered": false
        },
        "id": "e8-complex-output",
        "source": "Agent:AdvancedRetrieval",
        "sourceHandle": "start",
        "target": "Message:ComplexOutput",
        "targetHandle": "end"
      },
      {
        "data": {
          "isHovered": false
        },
        "id": "xy-edge__Agent:SimpleRetrievaltool-Tool:PetiteBroomsDesignend",
        "source": "Agent:SimpleRetrieval",
        "sourceHandle": "tool",
        "target": "Tool:PetiteBroomsDesign",
        "targetHandle": "end"
      },
      {
        "data": {
          "isHovered": false
        },
        "id": "xy-edge__Agent:AdvancedRetrievaltool-Tool:BlueEmusWorryend",
        "source": "Agent:AdvancedRetrieval",
        "sourceHandle": "tool",
        "target": "Tool:BlueEmusWorry",
        "targetHandle": "end"
      }
    ],
    "nodes": [
      {
        "data": {
          "form": {
            "enablePrologue": true,
            "inputs": {},
            "mode": "conversational",
            "outputs": {},
            "prologue": "Hi! I'm your AI assistant with access to a knowledge base. Ask me anything!"
          },
          "label": "Begin",
          "name": "begin"
        },
        "id": "begin",
        "measured": {
          "height": 82,
          "width": 200
        },
        "position": {
          "x": -600,
          "y": 0
        },
        "sourcePosition": "right",
        "targetPosition": "left",
        "type": "beginNode"
      },
      {
        "data": {
          "form": {
            "items": [
              {
                "description": "Greetings, casual chat, thank yous, or questions that don't require knowledge retrieval. Examples: 'Hello', 'How are you?', 'Thanks!', 'What can you do?'",
                "examples": [
                  {
                    "value": "Hi there"
                  },
                  {
                    "value": "Thank you"
                  }
                ],
                "name": "Conversational",
                "uuid": "uuid-conversational-001"
              },
              {
                "description": "Straightforward factual questions answerable with specific information. Starts with 'What is', 'When is', 'Who is', 'Where is'. No comparison or complex reasoning needed.",
                "examples": [
                  {
                    "value": "What is machine learning?"
                  },
                  {
                    "value": "Who invented the telephone?"
                  }
                ],
                "name": "Simple_Lookup",
                "uuid": "uuid-simple-lookup-002"
              },
              {
                "description": "Complex queries requiring analysis, comparison, or synthesis across multiple sources. Includes 'How' or 'Why' questions, summaries, comparisons. Triggers comprehensive retrieval.",
                "examples": [
                  {
                    "value": "Compare supervised and unsupervised learning"
                  },
                  {
                    "value": "Why did the Roman Empire fall?"
                  }
                ],
                "name": "Complex_Analysis",
                "uuid": "uuid-complex-analysis-003"
              }
            ],
            "llm_id": "phi4:latest@Ollama",
            "message_history_window_size": 1,
            "outputs": {
              "category_name": {
                "type": "string"
              }
            },
            "parameter": "Precise",
            "query": "sys.query",
            "temperature": 0.1,
            "temperatureEnabled": false
          },
          "label": "Categorize",
          "name": "Query Router"
        },
        "id": "Categorize:QueryRouter",
        "measured": {
          "height": 186,
          "width": 200
        },
        "position": {
          "x": -300,
          "y": 0
        },
        "sourcePosition": "right",
        "targetPosition": "left",
        "type": "categorizeNode"
      },
      {
        "data": {
          "form": {
            "cite": false,
            "frequencyPenaltyEnabled": false,
            "frequency_penalty": 0.7,
            "llm_id": "llama3.2:latest@Ollama",
            "maxTokensEnabled": false,
            "max_retries": 1,
            "max_rounds": 1,
            "max_tokens": 512,
            "message_history_window_size": 12,
            "outputs": {
              "content": {
                "type": "string",
                "value": ""
              }
            },
            "presencePenaltyEnabled": false,
            "presence_penalty": 0.4,
            "prompts": [
              {
                "content": "{sys.query}",
                "role": "user"
              }
            ],
            "sys_prompt": "You are a helpful assistant. Respond to greetings and casual conversation in 1-2 sentences. Be friendly but brief. Do not access the knowledge base for conversational queries.",
            "temperature": 0.7,
            "temperatureEnabled": true,
            "tools": [],
            "topPEnabled": false,
            "top_p": 0.3
          },
          "label": "Agent",
          "name": "Conversational Agent"
        },
        "id": "Agent:ConversationalSimple",
        "measured": {
          "height": 90,
          "width": 200
        },
        "position": {
          "x": 0,
          "y": -150
        },
        "selected": false,
        "sourcePosition": "right",
        "targetPosition": "left",
        "type": "agentNode"
      },
      {
        "data": {
          "form": {
            "cite": true,
            "frequencyPenaltyEnabled": false,
            "frequency_penalty": 0.7,
            "llm_id": "gemma3:27b@Ollama",
            "maxTokensEnabled": false,
            "max_retries": 2,
            "max_rounds": 1,
            "max_tokens": 2048,
            "message_history_window_size": 12,
            "outputs": {
              "content": {
                "type": "string",
                "value": ""
              }
            },
            "presencePenaltyEnabled": false,
            "presence_penalty": 0.4,
            "prompts": [
              {
                "content": "{sys.query}",
                "role": "user"
              }
            ],
            "sys_prompt": "You are a factual Q&A assistant. Answer questions using ONLY information from the knowledge base.\n\nWORKFLOW:\n1. Search the knowledge base using the search_knowledge_base tool\n2. Carefully read ALL retrieved documents (each has an ID like \"ID: 123\")\n3. Answer based ONLY on what you find in the retrieved content\n\nRESPONSE RULES:\n- Give a direct, concise answer (1-3 sentences)\n- Base your answer ONLY on the retrieved content\n- NEVER fabricate information not found in the documents\n\nCITATION RULES (CRITICAL):\n- You MUST cite sources using [ID:N] format (e.g., [ID:42])\n- Place ALL citations at the END of your answer as: References: [ID:X][ID:Y]\n- Do NOT place citations inline within sentences\n- The ID number comes from each chunk's \"ID:\" field\n\nHANDLING INSUFFICIENT INFORMATION:\n- If retrieved content contains ANY relevant information, use it to provide an answer\n- Only say \"No relevant information found\" if content is COMPLETELY unrelated to the question\n- When information is partial, answer what you can and note what's missing\n\nEXAMPLE FORMAT:\n[Your concise answer, 1-3 sentences, no inline citations]\n\nReferences: [ID:15][ID:87]",
            "temperature": 0.4,
            "temperatureEnabled": true,
            "tools": [
              {
                "component_name": "Retrieval",
                "id": "Retrieval:KBSearch",
                "name": "search_knowledge_base",
                "params": {
                  "kb_ids": [
                    "6f357bd7f45f11f085b53ae7a67b446b"
                  ],
                  "similarity_threshold": 0.05,
                  "keywords_similarity_weight": 0.1,
                  "top_n": 15,
                  "top_k": 1024
                }
              }
            ],
            "topPEnabled": false,
            "top_p": 0.3
          },
          "label": "Agent",
          "name": "Simple Lookup Agent"
        },
        "dragging": false,
        "id": "Agent:SimpleRetrieval",
        "measured": {
          "height": 90,
          "width": 200
        },
        "position": {
          "x": 31.132788500612833,
          "y": 32.82328910311017
        },
        "selected": false,
        "sourcePosition": "right",
        "targetPosition": "left",
        "type": "agentNode"
      },
      {
        "data": {
          "form": {
            "cite": false,
            "frequencyPenaltyEnabled": false,
            "frequency_penalty": 0.7,
            "llm_id": "phi4:latest@Ollama",
            "maxTokensEnabled": false,
            "max_retries": 1,
            "max_rounds": 1,
            "max_tokens": 512,
            "message_history_window_size": 1,
            "outputs": {
              "content": {
                "type": "string",
                "value": ""
              }
            },
            "presencePenaltyEnabled": false,
            "presence_penalty": 0.4,
            "prompts": [
              {
                "content": "Analyze this query and create a retrieval plan:\n\n**Query:** {sys.query}\n\nProvide:\n1. 1-3 focused sub-questions (if query is multi-faceted)\n2. Key search terms and entities\n3. Retrieval strategy recommendation\n\nBe concise - 3-4 sentences total.",
                "role": "user"
              }
            ],
            "sys_prompt": "You are a query planning agent. Your job is to reformulate complex questions into effective search queries.\n\nFor each query:\n1. Identify the core information need\n2. Extract key terms, entities, and concepts\n3. Generate 1-3 alternative phrasings or sub-questions\n\nOutput format:\nSEARCH TERMS: [key terms]\nSUB-QUESTIONS: [if needed]\nSTRATEGY: [brief retrieval approach]",
            "temperature": 0.2,
            "temperatureEnabled": true,
            "tools": [],
            "topPEnabled": false,
            "top_p": 0.3
          },
          "label": "Agent",
          "name": "Query Planner"
        },
        "id": "Agent:Planner",
        "measured": {
          "height": 90,
          "width": 200
        },
        "position": {
          "x": 0,
          "y": 250
        },
        "selected": false,
        "sourcePosition": "right",
        "targetPosition": "left",
        "type": "agentNode"
      },
      {
        "data": {
          "form": {
            "cite": true,
            "frequencyPenaltyEnabled": false,
            "frequency_penalty": 0.7,
            "llm_id": "gemma3:27b@Ollama",
            "maxTokensEnabled": false,
            "max_retries": 2,
            "max_rounds": 1,
            "max_tokens": 4096,
            "message_history_window_size": 12,
            "outputs": {
              "content": {
                "type": "string",
                "value": ""
              }
            },
            "presencePenaltyEnabled": false,
            "presence_penalty": 0.4,
            "prompts": [
              {
                "content": "{sys.query}",
                "role": "user"
              }
            ],
            "sys_prompt": "You are a research assistant. Answer questions using ONLY information from the knowledge base.\n\nWORKFLOW:\n1. Search the knowledge base using the search_knowledge_base tool\n2. Carefully read ALL retrieved documents (each has an ID like \"ID: 123\")\n3. Synthesize information from multiple sources if available\n4. Answer based ONLY on what you find\n\nRESPONSE RULES:\n- Give a thorough but concise answer (max 5 sentences)\n- Synthesize information from multiple retrieved chunks when relevant\n- Base your answer ONLY on the retrieved content\n- NEVER fabricate information not found in the documents\n\nCITATION RULES (CRITICAL):\n- You MUST cite sources using [ID:N] format (e.g., [ID:42])\n- Place ALL citations at the END as: References: [ID:X][ID:Y][ID:Z]\n- Do NOT place citations inline within sentences\n- The ID number comes from each chunk's \"ID:\" field\n\nHANDLING INSUFFICIENT INFORMATION:\n- If retrieved content contains ANY relevant information, use it to provide an answer\n- Only say \"No relevant information found\" if content is COMPLETELY unrelated\n- When information is partial, answer what you can and note what's missing\n- For complex questions, synthesize partial information from multiple sources\n\nEXAMPLE FORMAT:\n[Your answer, up to 5 sentences, no inline citations]\n\nReferences: [ID:15][ID:42][ID:87]",
            "temperature": 0.4,
            "temperatureEnabled": true,
            "tools": [
              {
                "component_name": "Retrieval",
                "id": "Retrieval:KBSearch",
                "name": "search_knowledge_base",
                "params": {
                  "kb_ids": [
                    "6f357bd7f45f11f085b53ae7a67b446b"
                  ],
                  "similarity_threshold": 0.05,
                  "keywords_similarity_weight": 0.1,
                  "top_n": 15,
                  "top_k": 1024
                }
              }
            ],
            "topPEnabled": false,
            "top_p": 0.3
          },
          "label": "Agent",
          "name": "Advanced Retrieval Agent"
        },
        "id": "Agent:AdvancedRetrieval",
        "measured": {
          "height": 90,
          "width": 200
        },
        "position": {
          "x": 300,
          "y": 250
        },
        "selected": true,
        "sourcePosition": "right",
        "targetPosition": "left",
        "type": "agentNode"
      },
      {
        "data": {
          "form": {
            "content": [
              "{Agent:ConversationalSimple@content}"
            ]
          },
          "label": "Message",
          "name": "Conversational Output"
        },
        "id": "Message:ConversationalOutput",
        "measured": {
          "height": 86,
          "width": 200
        },
        "position": {
          "x": 300,
          "y": -150
        },
        "sourcePosition": "right",
        "targetPosition": "left",
        "type": "messageNode"
      },
      {
        "data": {
          "form": {
            "content": [
              "{Agent:SimpleRetrieval@content}"
            ]
          },
          "label": "Message",
          "name": "Simple Lookup Output"
        },
        "id": "Message:SimpleOutput",
        "measured": {
          "height": 86,
          "width": 200
        },
        "position": {
          "x": 300,
          "y": 50
        },
        "sourcePosition": "right",
        "targetPosition": "left",
        "type": "messageNode"
      },
      {
        "data": {
          "form": {
            "content": [
              "{Agent:AdvancedRetrieval@content}"
            ]
          },
          "label": "Message",
          "name": "Complex Analysis Output"
        },
        "id": "Message:ComplexOutput",
        "measured": {
          "height": 86,
          "width": 200
        },
        "position": {
          "x": 600,
          "y": 250
        },
        "sourcePosition": "right",
        "targetPosition": "left",
        "type": "messageNode"
      },
      {
        "data": {
          "form": {
            "description": "This is an agent for a specific task.",
            "user_prompt": "This is the order you need to send to the agent."
          },
          "label": "Tool",
          "name": "flow.tool_0"
        },
        "id": "Tool:PetiteBroomsDesign",
        "measured": {
          "height": 50,
          "width": 200
        },
        "position": {
          "x": -50.86721149938717,
          "y": 172.82328910311017
        },
        "selected": false,
        "sourcePosition": "right",
        "targetPosition": "left",
        "type": "toolNode"
      },
      {
        "data": {
          "form": {
            "description": "This is an agent for a specific task.",
            "user_prompt": "This is the order you need to send to the agent."
          },
          "label": "Tool",
          "name": "flow.tool_1"
        },
        "id": "Tool:BlueEmusWorry",
        "measured": {
          "height": 50,
          "width": 200
        },
        "position": {
          "x": 218,
          "y": 390
        },
        "selected": false,
        "sourcePosition": "right",
        "targetPosition": "left",
        "type": "toolNode"
      }
    ]
  },
  "history": [],
  "memory": [],
  "messages": [],
  "path": [],
  "retrieval": [
    {
      "chunks": {},
      "doc_aggs": {}
    }
  ],
  "task_id": "c71adc4d002011f18467121cbe6b8155",
  "variables": {},
  "edges": []
}