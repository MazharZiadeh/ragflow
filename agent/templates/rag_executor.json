{
  "id": 100,
  "title": {
    "en": "RAG Executor",
    "zh": "RAG执行器"
  },
  "description": {
    "en": "Optimized RAG agent with semantic-heavy search (30% keyword / 70% vector), low similarity threshold, and image citation support.",
    "zh": "优化的RAG代理，具有语义优先搜索（30%关键词/70%向量）、低相似度阈值和图像引用支持。"
  },
  "canvas_type": "Agent",
  "dsl": {
    "components": {
      "begin": {
        "obj": {
          "component_name": "Begin",
          "params": {
            "prologue": "Hello! I can help you search and analyze information from the knowledge base with accurate citations."
          }
        },
        "downstream": ["Retrieval_Eval"],
        "upstream": []
      },
      "Retrieval_Eval": {
        "obj": {
          "component_name": "Retrieval",
          "params": {
            "similarity_threshold": 0.1,
            "keywords_similarity_weight": 0.3,
            "top_n": 10,
            "top_k": 1024,
            "rerank_id": "",
            "empty_response": "No relevant information found in the knowledge base. Please try rephrasing your question or check if the knowledge base contains relevant content.",
            "kb_ids": [],
            "use_kg": false,
            "cross_languages": [],
            "toc_enhance": false,
            "meta_data_filter": {},
            "inputs": {
              "query": {
                "name": "Query",
                "type": "line",
                "value": "{{Agent:QuerySampler@content}}"
              }
            },
            "outputs": {
              "formalized_content": {
                "type": "string",
                "value": ""
              },
              "json": {
                "type": "array",
                "value": []
              }
            }
          }
        },
        "downstream": ["RAGExecutor"],
        "upstream": ["begin"]
      },
      "RAGExecutor": {
        "obj": {
          "component_name": "LLM",
          "params": {
            "llm_id": "",
            "cite": true,
            "temperature": 0,
            "top_p": 0.9,
            "max_tokens": 4096,
            "sys_prompt": "You are an expert research assistant. You MUST answer ONLY using the RETRIEVED CONTEXT below. Do NOT use any prior knowledge.\n\n=== RETRIEVED CONTEXT START ===\n{Retrieval_Eval@formalized_content}\n=== RETRIEVED CONTEXT END ===\n\nRULES:\n1. ONLY use facts explicitly stated in the RETRIEVED CONTEXT. Never add outside knowledge.\n2. CITE EVERY fact using [ID:N] where N is the chunk ID from the context.\n3. Information may span multiple chunks — combine them, but ONLY from the context above.\n4. If the context does not contain the answer, respond EXACTLY: \"No relevant information found in the knowledge base.\"\n5. Do NOT invent or fabricate source names, page numbers, authors, or any metadata not present in the context.\n6. When the context includes document names or page numbers, include them naturally in your answer.\n7. Start with a direct answer, then provide supporting details — each with citations.",
            "prompts": [{"role": "user", "content": "Question: {sys.query}\n\nAnswer using ONLY the retrieved context above. Cite every fact with [ID:N]."}],
            "message_history_window_size": 13,
            "outputs": {
              "content": {
                "type": "string",
                "value": ""
              }
            }
          }
        },
        "downstream": ["message:0"],
        "upstream": ["Retrieval_Eval"]
      },
      "message:0": {
        "obj": {
          "component_name": "Message",
          "params": {
            "content": ["{RAGExecutor@content}"]
          }
        },
        "downstream": [],
        "upstream": ["RAGExecutor"]
      }
    },
    "history": [],
    "messages": [],
    "path": [],
    "retrieval": {"chunks": {}, "doc_aggs": {}},
    "globals": {
      "sys.query": "",
      "sys.user_id": "",
      "sys.conversation_turns": 0,
      "sys.files": []
    }
  }
}
