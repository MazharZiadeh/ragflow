{
  "id": 100,
  "title": {
    "en": "RAG Executor",
    "zh": "RAG执行器"
  },
  "description": {
    "en": "Optimized RAG agent with semantic-heavy search (30% keyword / 70% vector), low similarity threshold, and image citation support.",
    "zh": "优化的RAG代理，具有语义优先搜索（30%关键词/70%向量）、低相似度阈值和图像引用支持。"
  },
  "canvas_type": "Agent",
  "dsl": {
    "components": {
      "begin": {
        "obj": {
          "component_name": "Begin",
          "params": {
            "prologue": "Hello! I can help you search and analyze information from the knowledge base with accurate citations."
          }
        },
        "downstream": ["Retrieval_Eval"],
        "upstream": []
      },
      "Retrieval_Eval": {
        "obj": {
          "component_name": "Retrieval",
          "params": {
            "similarity_threshold": 0.1,
            "keywords_similarity_weight": 0.3,
            "top_n": 10,
            "top_k": 1024,
            "rerank_id": "",
            "empty_response": "No relevant information found in the knowledge base. Please try rephrasing your question or check if the knowledge base contains relevant content.",
            "kb_ids": [],
            "use_kg": false,
            "cross_languages": [],
            "toc_enhance": false,
            "meta_data_filter": {},
            "inputs": {
              "query": {
                "name": "Query",
                "type": "line",
                "value": "{{Agent:QuerySampler@content}}"
              }
            },
            "outputs": {
              "formalized_content": {
                "type": "string",
                "value": ""
              },
              "json": {
                "type": "array",
                "value": []
              }
            }
          }
        },
        "downstream": ["RAGExecutor"],
        "upstream": ["begin"]
      },
      "RAGExecutor": {
        "obj": {
          "component_name": "LLM",
          "params": {
            "llm_id": "",
            "cite": true,
            "temperature": 0,
            "top_p": 0.9,
            "max_tokens": 4096,
            "sys_prompt": "You are an expert research assistant. Answer the user's question using the RETRIEVED CONTEXT provided below.\n\nRULES:\n1. Base your answer strictly on the RETRIEVED CONTEXT. Do not add outside knowledge.\n2. Cite facts using [ID:N] where N is the chunk ID.\n3. Combine information from multiple chunks when relevant.\n4. Do NOT fabricate source names, page numbers, authors, or metadata not in the context.\n5. Include document names or page numbers from the context naturally in your answer.\n6. Start with a direct answer, then supporting details with citations.\n7. Only say \"No relevant information found\" if the context is entirely unrelated to the question.\n\n=== RETRIEVED CONTEXT START ===\n{Retrieval_Eval@formalized_content}\n=== RETRIEVED CONTEXT END ===",
            "prompts": [{"role": "user", "content": "Question: {sys.query}\n\nUse the retrieved context to answer this question. Extract relevant facts from the chunks and cite them with [ID:N]. If the context contains information that helps answer the question, even partially, use it."}],
            "message_history_window_size": 13,
            "outputs": {
              "content": {
                "type": "string",
                "value": ""
              }
            }
          }
        },
        "downstream": ["message:0"],
        "upstream": ["Retrieval_Eval"]
      },
      "message:0": {
        "obj": {
          "component_name": "Message",
          "params": {
            "content": ["{RAGExecutor@content}"]
          }
        },
        "downstream": [],
        "upstream": ["RAGExecutor"]
      }
    },
    "history": [],
    "messages": [],
    "path": [],
    "retrieval": {"chunks": {}, "doc_aggs": {}},
    "globals": {
      "sys.query": "",
      "sys.user_id": "",
      "sys.conversation_turns": 0,
      "sys.files": []
    }
  }
}
